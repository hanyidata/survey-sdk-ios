(self.webpackChunksurvey=self.webpackChunksurvey||[]).push([[941],{6941:function(e,t,n){"use strict";n.d(t,{Z:function(){return v}});var i=n(6257),s=(t=(n(9653),n(7327),n(1539),n(1249),n(7941),n(4747),n(2772),n(1058),n(4916),n(2222),n(1038),n(8783),n(7601),n(7042),n(7658),n(4986),{props:{survey:Object,question:Object,page:Object,halfscreen:Boolean},computed:{style:function(){return this.labelBgColorSet="--scoreLabelBgColor:"+this.survey.style.defaultTagPadding,this.survey.style},isVisible:function(){return this.question._visible&&this.question._skips<=0},gridRows:function(){var e;return this.question&&this.question.itemLayout?(e="TWO"==this.question.itemLayout?2:"THREE"==this.question.itemLayout?3:1,Math.ceil(this.question.items.length/e)):1},gridColumns:function(){return this.question&&this.question.itemLayout?"TWO"==this.question.itemLayout?2:"THREE"==this.question.itemLayout?3:1:1}},data:function(){return{labelBgColorSet:""}},methods:{arrayfind:function(e,t){return null!=e?e.indexOf(t):-1},colorRgb:function(e,t){var n=e.toLowerCase();if(/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(n)){if(4===n.length){for(var i="#",s=1;s<4;s+=1)i+=n.slice(s,s+1).concat(n.slice(s,s+1));n=i}for(var o=[],a=1;a<7;a+=2)o.push(parseInt("0x"+n.slice(a,a+2)));return"rgba("+o.join(",")+","+t+")"}return/^rgba(.*)$/.test(n)?(e=n.lastIndexOf(","),n.substr(0,e)+","+t+")"):n}}}),n(5030)),o={props:{checked:Boolean,color:String,byscore:Boolean}},a=n(9453),r=(o=(0,a.Z)(o,(function(){var e=this,t=e.$createElement;t=e._self._c||t;return t("v-uni-view",{staticClass:"ck-i-s-wrap",class:{"by-q-score":e.byscore}},[t("v-uni-view",{staticClass:"ck-w-input",class:{checked:e.checked},style:{backgroundColor:e.checked?e.color:"",color:e.checked?e.color:""}},[e.checked?t("v-uni-view",{staticClass:"ck-view"}):e._e()],1)],1)}),[],!1,null,null,null,!1,void 0,void 0).exports,s={mixins:[t,s.S],components:{"checkbox-item":o},computed:{value:function(){return this.question&&this.question._value},minValue:function(){return 0},maxValue:function(){return 10},length:function(){return Array.from({length:10},(function(e,t){return t+1}))},range:function(){var e,t=[];return this.question&&(e=10,e+=1,t=Array.from({length:e},(function(e,t){return t+0}))),t}},data:function(){return{}},methods:{handleClick:function(e,t){null==(e=e==this.value?null:e)?this.currentIndex=-1:e<=6?this.currentIndex=0:6<e&&e<=8?this.currentIndex=1:8<e&&e<=10&&(this.currentIndex=2),this.$emit("change",{key:this.question.name,value:e,comment:this.textarea||null,tags:0<this.checkedTags.length?this.checkedTags:null})}}},s=(0,a.Z)(s,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"hy-question hy-nps"},[e.question.showLabel?n("v-uni-view",{staticClass:"score-label",style:e.labelBgColorSet},[n("v-uni-view",{staticClass:"score-label-l left",style:{color:e.style.tagColor||"#999",background:e.style.defaultTagPadding}},[n("v-uni-rich-text",{staticClass:"label-text",attrs:{nodes:e.question.labels[0]}})],1),n("v-uni-view",{staticClass:"score-label-l right",style:{color:e.style.tagColor||"#999",background:e.style.defaultTagPadding}},[n("v-uni-rich-text",{staticClass:"label-text",attrs:{nodes:e.question.labels[1]}})],1)],1):e._e(),n("v-uni-view",{staticClass:"q-score Number"},e._l(e.range,(function(t,i){return n("v-uni-label",{key:i,staticClass:"q-score-i",class:{active:null!==e.value&&t<=e.value,item_left:t<=e.minValue,item_right:t==e.value||t==e.maxValue,item_mid:t>e.minValue&&t<e.maxValue},style:{backgroundColor:null!==e.value&&t<=e.value&&e.style?e.style.mainColor:"#e8eef4"},on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.handleClick(t,i)}}},[e._v(e._s(t))])})),1),null!==e.currentIndex&&e.question.items&&e.question.items[e.currentIndex]&&e.question.items[e.currentIndex].configure&&0<e.currentTags.length&&e.question.showTags?n("v-uni-view",{class:{"show-tags":!0,two:2===e.currentTags.length,"adaptive-tag":"ADAPTIVE"===e.question.labelLayout}},e._l(e.currentTags,(function(t,i){return n("v-uni-view",{key:i,staticClass:"eval-tag-i flex-center",class:{active:e.isTagsActive[i]},style:{background:e.isTagsActive[i]?e.style.selectedTagPadding:e.style.defaultTagPadding,color:e.isTagsActive[i]?e.style.mainColor:e.style.tagColor,borderColor:e.isTagsActive[i]?e.style.selectedTagStroke:e.style.defaultTagStroke},on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.checkTag(t,i)}}},[n("v-uni-rich-text",{staticClass:"rich-text",attrs:{nodes:t}})],1)})),1):e._e(),e.question.hasOther&&null!==e.currentIndex&&e.showTextarea?n("v-uni-textarea",{staticClass:"eval-area",style:{backgroundColor:e.style.defaultTagPadding,color:e.style.itemColor,border:"1px solid "+e.style.defaultTagStroke},attrs:{type:"textarea",placeholder:e.question.placeHolder,maxlength:"300"},on:{input:function(t){arguments[0]=t=e.$handleEvent(t),e.checkText.apply(void 0,arguments)}},model:{value:e.textarea,callback:function(t){e.textarea=t},expression:"textarea"}}):e._e()],1)}),[],!1,null,null,null,!1,void 0,void 0).exports,(0,a.Z)({mixins:[t],data:function(){return{textVal:""}},beforeMount:function(){this.init()},methods:{init:function(){this.question._value&&(this.textVal=this.question._value)},handleChange:function(e){this.$emit("change",{key:this.question.name,value:e.detail.value})},handleFocus:function(){this.$emit("focus",this.question.code)},handleBlur:function(){this.$emit("blur",this.question.code)}}},(function(){var e=this,t=e.$createElement;t=e._self._c||t;return t("v-uni-view",{staticClass:"hy-question hy-text",class:{"half-screen-question":e.halfscreen,"default-question":!e.halfscreen}},["TEXTAREA"===e.question.inputType?t("v-uni-textarea",{staticClass:"text textarea",attrs:{"placeholder-class":"placehoder-s",placeholder:e.question.placeHolder,maxlength:e.question.maxLength||-1},on:{input:function(t){arguments[0]=t=e.$handleEvent(t),e.handleChange.apply(void 0,arguments)},focus:function(t){arguments[0]=t=e.$handleEvent(t),e.handleFocus.apply(void 0,arguments)},blur:function(t){arguments[0]=t=e.$handleEvent(t),e.handleBlur.apply(void 0,arguments)}},model:{value:e.textVal,callback:function(t){e.textVal=t},expression:"textVal"}}):t("v-uni-input",{staticClass:"text input",attrs:{maxlength:e.question.maxLength||-1,"placeholder-class":"placehoder-s",placeholder:e.question.placeHolder},on:{input:function(t){arguments[0]=t=e.$handleEvent(t),e.handleChange.apply(void 0,arguments)},focus:function(t){arguments[0]=t=e.$handleEvent(t),e.handleFocus.apply(void 0,arguments)},blur:function(t){arguments[0]=t=e.$handleEvent(t),e.handleBlur.apply(void 0,arguments)}},model:{value:e.textVal,callback:function(t){e.textVal=t},expression:"textVal"}})],1)}),[],!1,null,null,null,!1,void 0,void 0).exports),u=(0,a.Z)({mixins:[t],components:{"checkbox-item":o},computed:{value:function(){var e=this.question&&this.question._value;return this.applicableLabel=-1==e,e},minValue:function(){return this.question.min},maxValue:function(){var e=10;return this.question?this.question.maxLength:e},length:function(){var e=10;return this.question&&(e=this.question.maxLength||10),Array.from({length:e},(function(e,t){return t+1}))},range:function(){var e,t,n=[];return this.question&&(e=null!=this.question.min?this.question.min:1,t=null!=this.question.max?this.question.max:10,0===(e=this.question.isNps?0:e)&&(t+=1),n=Array.from({length:t},(function(t,n){return n+e}))),n}},data:function(){return{applicableLabel:!1}},methods:{handleClick:function(e,t){e==this.value&&(e=null),this.applicableLabel=!1,this.$emit("change",{key:this.question.name,value:e})},handleChange:function(){this.applicableLabel=!this.applicableLabel,this.$emit("change",{key:this.question.name,value:this.applicableLabel?-1:null})}}},(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"hy-question hy-score"},[e.question.showLabel?n("v-uni-view",{staticClass:"score-label",style:e.labelBgColorSet},[n("v-uni-view",{staticClass:"score-label-l left",style:{color:e.style.tagColor||"#999",background:e.style.defaultTagPadding}},[n("v-uni-rich-text",{staticClass:"label-text",attrs:{nodes:e.question.labels[0]}})],1),n("v-uni-view",{staticClass:"score-label-l right",style:{color:e.style.tagColor||"#999",background:e.style.defaultTagPadding}},[n("v-uni-rich-text",{staticClass:"label-text",attrs:{nodes:e.question.labels[1]}})],1)],1):e._e(),"NUMBER"==e.question.inputType?n("v-uni-view",{staticClass:"q-score Number"},e._l(e.range,(function(t,i){return n("v-uni-label",{key:i,staticClass:"q-score-i",class:{active:null!==e.value&&t<=e.value,item_left:t<=e.minValue,item_right:t==e.value||t==e.maxValue,item_mid:t>e.minValue&&t<e.maxValue},style:{backgroundColor:null!==e.value&&t<=e.value&&e.style?e.style.mainColor:"#e8eef4"},on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.handleClick(t,i)}}},[e._v(e._s(t))])})),1):n("v-uni-view",{staticClass:"q-score not-Number"},e._l(e.length,(function(t,i){return n("v-uni-label",{key:i,staticClass:"q-score-i"},[n("v-uni-view",{staticClass:"eval-emo",class:{star:"STAR"===e.question.inputType&&(!e.question._value||-1==e.question._value||e.question._value<i+1),star_active:"STAR"===e.question.inputType&&e.question._value>=i+1,icon:"ICON"===e.question.inputType&&(!e.question._value||-1==e.question._value||e.question._value<i+1),icon_active:"ICON"===e.question.inputType&&e.question._value>=i+1,like:"LIKE"===e.question.inputType&&(!e.question._value||-1==e.question._value||e.question._value<i+1),like_active:"LIKE"===e.question.inputType&&e.question._value>=i+1},on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.handleClick(t,i)}}})],1)})),1),e.question.inapplicable?n("v-uni-view",{staticClass:"q-inapplicable",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleChange.apply(void 0,arguments)}}},[n("checkbox-item",{staticClass:"q-inapp-checbox",attrs:{color:e.survey.style.mainColor,checked:e.applicableLabel}}),n("v-uni-view",{staticClass:"q-in-label",style:{color:e.style.itemColor||"#333333"}},[n("v-uni-rich-text",{attrs:{nodes:e.question.inapplicableLabel}})],1)],1):e._e()],1)}),[],!1,null,null,null,!1,void 0,void 0).exports,l=n(6407),c=n(4587),h=(n(8862),{props:{checked:Boolean,color:String}}),d=(h=(0,a.Z)(h,(function(){var e=this,t=e.$createElement;t=e._self._c||t;return t("v-uni-view",{staticClass:"radio-item-w"},[t("v-uni-view",{staticClass:"radio-input",class:{checked:e.checked},style:{backgroundColor:e.checked?e.color:"",borderColor:e.checked?e.color:""}},[e.checked?t("v-uni-view",{staticClass:"checked-view"}):e._e()],1)],1)}),[],!1,null,null,null,!1,void 0,void 0).exports,n(5306),{props:{question:Object,item:Object,ncolumn:Boolean},data:function(){return{inputModel:""}},created:function(){var e;this.question._comment&&(e=JSON.parse(this.question._comment),this.inputModel=e[this.item.value])},methods:{handleChange:function(e){var t=this.question._comment?JSON.parse(this.question._comment):{},n=this.inputModel.replace(/^\s\s*/,"").replace(/\s\s*$/,"");0<n.length?t[this.item.value]=n:delete t[this.item.value],n="{}"===JSON.stringify(t)?null:JSON.stringify(t);this.$emit("change",{key:this.question.name,value:this.question._value,comment:n})}}}),v=(d=(0,a.Z)(d,(function(){var e=this,t=e.$createElement;t=e._self._c||t;return t("v-uni-view",{staticClass:"hy-t-input",class:{"label-type":"LABEL"===e.question.inputType,ncolumn:e.ncolumn}},[t("v-uni-label",{staticClass:"required"},[e._v(e._s(e.item.isRequired?"*":""))]),t("v-uni-view",{staticClass:"item-text"},[t("v-uni-input",{staticClass:"text-input",attrs:{type:"text"},on:{input:function(t){arguments[0]=t=e.$handleEvent(t),e.handleChange.apply(void 0,arguments)}},model:{value:e.inputModel,callback:function(t){e.inputModel=t},expression:"inputModel"}})],1)],1)}),[],!1,null,null,null,!1,void 0,void 0).exports,h=(0,a.Z)({mixins:[t],components:{"hy-item-text-input":d,"radio-item":h},data:function(){return{items:[],textHeight:"unset"}},created:function(){var e=this;this.question.items.forEach((function(t){e.items.push({text:t.text,value:t.value,checked:!1,enableTextInput:t.enableTextInput,isRequired:t.isRequired})}))},beforeMount:function(){this.init()},mounted:function(){this.afterImgLoading()},methods:{init:function(){var e=this;this.question._value&&this.question.items.forEach((function(t,n){e.items[n].checked=t.value===e.question._value}))},handleChange:function(e){var t=e.value,n=this.question._comment?JSON.parse(this.question._comment):{};this.items.forEach((function(e,i){var s=e.value;e.checked=t==e.value,n[s]&&!e.checked&&delete n[s]})),e={key:this.question.name};0<t.length&&(e.value=t),"{}"!==JSON.stringify(n)&&(e.comment=JSON.stringify(n)),this.$emit("change",e)},handleItemInputChange:function(e){this.$emit("change",e)},initStyle:function(){var e=this;return(0,c.Z)((0,l.Z)().mark((function t(){var n,i,s,o;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("ONE"===e.question.itemLayout&&"CLASSIC"===e.question.inputType)return t.abrupt("return");t.next=2;break;case 2:return t.next=4,e.$nextTick();case 4:n=uni.createSelectorQuery().in(e),i=0,s=[],o=".hy-single-choice .radio-i.item-".concat(e.question.id," .radio-i-text"),n.selectAll(o).boundingClientRect((function(t){t.forEach((function(e){s.push(e.height)})),i=Math.max.apply(null,s),e.textHeight=i+"px"})).exec();case 9:case"end":return t.stop()}}),t)})))()},afterImgLoading:function(){var e,t=this;this.question.items&&0!=this.question.items.length&&(e=setTimeout((function(){t.initStyle(),clearTimeout(e)}),500))}}},(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"hy-question hy-single-choice",class:[{"column-and-tag":"LABEL"===e.question.inputType&&"ONE"!==e.question.itemLayout&&!e.halfscreen,"tag-item":"LABEL"===e.question.inputType&&"ONE"===e.question.itemLayout&&!e.halfscreen,"n-column":"LABEL"!==e.question.inputType&&"ONE"!==e.question.itemLayout&&!e.halfscreen,"half-screen-question":e.halfscreen,"default-question":!e.halfscreen},"item-column-"+e.question.itemLayout.toLowerCase()]},[e.halfscreen?[n("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:e.question&&e.question.items,expression:"question && question.items"}],staticClass:"radio-group"},e._l(e.items,(function(t,i){return n("v-uni-view",{key:i,staticClass:"radio-i",class:{checked:t.checked},style:{borderColor:t.checked?e.style.mainColor:"transparent",backgroundColor:e.halfscreen?t.checked?e.style.selectedTagPadding:e.style.defaultTagPadding:"transparent"},on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.handleChange(t)}}},[n("v-uni-label",{staticClass:"radio-i-row"},[n("v-uni-label",{staticClass:"radio-i-label item-content",style:{color:t.checked?e.style.mainColor:e.style.itemColor||"#333333"}},[n("v-uni-rich-text",{staticClass:"radio-i-text",attrs:{nodes:t.text}})],1)],1)],1)})),1)]:[n("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:e.question&&e.question.items,expression:"question && question.items"}],staticClass:"radio-group"},e._l(e.items,(function(t,i){return n("v-uni-view",{key:i,staticClass:"radio-i",class:["item-"+e.question.id,{checked:t.checked}],style:{backgroundColor:"LABEL"!==e.question.inputType||t.checked?"":e.style.defaultTagPadding}},[n("v-uni-label",{staticClass:"radio-i-row",style:{backgroundColor:"LABEL"===e.question.inputType&&t.checked?e.style.selectedTagPadding:""},on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.handleChange(t)}}},["LABEL"!==e.question.inputType?n("radio-item",{attrs:{byscore:!1,color:e.style.mainColor,checked:t.checked}}):e._e(),n("v-uni-label",{staticClass:"radio-i-label item-content",style:{color:"LABEL"===e.question.inputType&&t.checked?e.style.mainColor:e.style.itemColor||"#333333"}},[n("v-uni-rich-text",{staticClass:"radio-i-text",style:{height:e.textHeight},attrs:{nodes:t.text}})],1)],1),t&&t.enableTextInput&&e.question._value&&t.checked?n("v-uni-view",{staticClass:"item-text-input"},[n("hy-item-text-input",{key:t.id,attrs:{question:e.question,item:t,ncolumn:"LABEL"!==e.question.inputType&&"ONE"!==e.question.itemLayout},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.handleItemInputChange.apply(void 0,arguments)}}})],1):e._e()],1)})),1)]],2)}),[],!1,null,null,null,!1,void 0,void 0).exports,d=(n(6699),n(2023),(0,a.Z)({mixins:[t],components:{"hy-item-text-input":d,"checkbox-item":o},data:function(){return{items:[],textHeight:"unset"}},created:function(){var e=this;this.question.items.forEach((function(t){e.items.push({text:t.text,value:t.value,checked:!1,enableTextInput:t.enableTextInput,isRequired:t.isRequired})}))},beforeMount:function(){this.init()},mounted:function(){this.afterImgLoading()},methods:{itemCheckedClass:function(){return function(e){return this.question._value&&-1<this.question._value.indexOf(e.value)?"checked":""}},itemLabelBgColor:function(){return function(e){return"LABEL"!==this.question.inputType||this.question._value&&-1<this.question._value.indexOf(e.value)?{}:{backgroundColor:this.style.defaultTagPadding}}},init:function(){var e=this;this.question._value&&this.items.forEach((function(t,n){e.items[n].checked=-1<e.question._value.indexOf(t.value)}))},handleChange:function(e){var t=this.question._value||[],n=this.question._comment?JSON.parse(this.question._comment):{},i=(this.items.forEach((function(i,s){var o=i.value;o===e.value?i.checked=!i.checked:i.checked=t.includes(o),n[o]&&!i.checked&&delete n[o]})),this.items.filter((function(e){return e.checked})).map((function(e){return e.value}))),s={key:this.question.name};0<i.length&&(s.value=i),"{}"!==JSON.stringify(n)&&(s.comment=JSON.stringify(n)),this.$emit("change",s)},handleItemInputChange:function(e){this.$emit("change",e)},initStyle:function(){var e=this;return(0,c.Z)((0,l.Z)().mark((function t(){var n,i,s,o;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("ONE"===e.question.itemLayout&&"CLASSIC"===e.question.inputType)return t.abrupt("return");t.next=2;break;case 2:return t.next=4,e.$nextTick();case 4:n=uni.createSelectorQuery().in(e),i=0,s=[],o=".hy-multiple-choice .ck-i.item-".concat(e.question.id," .ck-l-text"),n.selectAll(o).boundingClientRect((function(t){t.forEach((function(e){s.push(e.height)})),i=Math.max.apply(null,s),e.textHeight=i+"px"})).exec();case 9:case"end":return t.stop()}}),t)})))()},afterImgLoading:function(){var e,t=this;this.question.items&&0!=this.question.items.length&&(e=setTimeout((function(){t.initStyle(),clearTimeout(e)}),500))}}},(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"hy-question hy-multiple-choice",class:[{"column-and-tag":"LABEL"===e.question.inputType&&"ONE"!==e.question.itemLayout&&!e.halfscreen,"tag-item":"LABEL"===e.question.inputType&&"ONE"===e.question.itemLayout&&!e.halfscreen,"n-column":"LABEL"!==e.question.inputType&&"ONE"!==e.question.itemLayout&&!e.halfscreen,"half-screen-question":e.halfscreen,"default-question":!e.halfscreen},"item-column-"+e.question.itemLayout.toLowerCase()]},[e.halfscreen?[n("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:e.question&&e.question.items,expression:"question && question.items"}],staticClass:"ck-group"},e._l(e.items,(function(t,i){return n("v-uni-view",{key:i,staticClass:"ck-i",class:{checked:t.checked},style:{borderColor:t.checked?e.style.mainColor:"transparent",backgroundColor:e.halfscreen?t.checked?e.style.selectedTagPadding:e.style.defaultTagPadding:"transparent"},on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.handleChange(t)}}},[n("v-uni-label",{staticClass:"ck-i-row"},[n("v-uni-label",{staticClass:"ck-label item-content",style:{color:t.checked?e.style.mainColor:e.style.itemColor||"#333333"}},[n("v-uni-rich-text",{staticClass:"ck-l-text",attrs:{nodes:t.text}})],1)],1)],1)})),1)]:[n("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:e.question&&e.question.items,expression:"question && question.items"}],staticClass:"ck-group"},e._l(e.items,(function(t,i){return n("v-uni-view",{key:i,staticClass:"ck-i",class:["item-"+e.question.id,{checked:t.checked}],style:{backgroundColor:"LABEL"!==e.question.inputType||t.checked?"":e.style.defaultTagPadding}},[n("v-uni-label",{staticClass:"ck-i-row",style:{backgroundColor:"LABEL"===e.question.inputType&&t.checked?e.style.selectedTagPadding:""},on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.handleChange(t)}}},["LABEL"!==e.question.inputType?n("checkbox-item",{attrs:{byscore:!1,color:e.style.mainColor,checked:t.checked}}):e._e(),n("v-uni-label",{staticClass:"ck-label item-content",style:{color:"LABEL"===e.question.inputType&&t.checked?e.style.mainColor:e.style.itemColor||"#333333"}},[n("v-uni-rich-text",{staticClass:"ck-l-text",style:{height:e.textHeight},attrs:{nodes:t.text}})],1)],1),t&&t.enableTextInput&&e.question._value&&t.checked?n("v-uni-view",{staticClass:"item-text-input"},[n("hy-item-text-input",{key:t.id,attrs:{question:e.question,item:t,ncolumn:"LABEL"!==e.question.inputType&&"ONE"!==e.question.itemLayout},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.handleItemInputChange.apply(void 0,arguments)}}})],1):e._e()],1)})),1)]],2)}),[],!1,null,null,null,!1,void 0,void 0).exports),o=(n(561),{data:function(){return{currentIndex:-1,checkedTags:[],checkedIndex:[],textarea:"",tagDefaultStyle:null,tagActiveStyle:null,imageTypeClass:""}},computed:{currentTags:function(){return-1<this.currentIndex?this.question.items[this.currentIndex].configure.split(","):[]},isTagsActive:function(){var e=this,t=[];return this.currentTags.forEach((function(n){-1<e.arrayfind(e.checkedTags,n)?t.push(!0):t.push(!1)})),t}},beforeMount:function(){this.init()},methods:{isItemActived:function(e){return this.question._value===e.value||!this.question._value&&this.question.isDefaultValue&&this.question.evaluationValue===e.value},init:function(){var e=this;!this.question._value&&this.question.isDefaultValue&&(this.question._value=this.question.evaluationValue),this.question._value&&(this.question.items.forEach((function(t,n){var i;t.value===e.question._value&&(e.currentIndex=n,(i=e.question._tags)&&i.length&&t.configure&&t.configure.split(",").forEach((function(t,n){-1<i.indexOf(t)&&(e.checkedIndex.push(n),e.checkedTags.push(t))})),e.textarea=e.question._comment)})),this.question._comment&&(this.textarea=this.question._comment),this.changeValue()),this.tagDefaultStyle={background:this.style.defaultTagPadding,color:this.style.tagColor,borderColor:this.style.defaultTagStroke},this.tagActiveStyle={background:this.style.selectedTagPadding,color:this.style.mainColor,borderColor:this.style.selectedTagStroke},this.imageTypeClass=this.question.inputType},checkEmo:function(e,t){this.checkedTags=[],this.checkedIndex=[],this.currentIndex=t,this.changeValue()},changeValue:function(){var e={key:this.question.name,value:-1<this.currentIndex?this.question.items[this.currentIndex].value:null,comment:this.textarea||null,tags:0<this.checkedTags.length?this.checkedTags:null};this.$emit("change",e)},checkTag:function(e,t){var n=this.checkedIndex.indexOf(t);-1!=n?(this.checkedIndex.splice(n,1),this.checkedTags.splice(n,1)):(this.checkedIndex.push(t),this.checkedTags.push(e)),this.question._tags=this.checkedTags,this.changeValue()},checkText:function(){this.changeValue()}}}),r={components:{"hy-question-text":r,"hy-question-score":u,"hy-question-single-choice":h,"hy-question-multiple-choice":d,"hy-question-evaluation":(0,a.Z)({mixins:[t,o]},(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"hy-question hy-evalution",class:{"seleted-show":"SELECT"===e.question.itemLayout,"half-screen-question":e.halfscreen}},[n("v-uni-view",{staticClass:"show-images",class:{"with-text":"ALWAYS"===e.question.itemLayout}},e._l(e.question.items,(function(t,i){return n("v-uni-view",{key:i,staticClass:"eval-img-i",class:{active:e.isItemActived(t)},style:{borderColor:e.halfscreen?e.isItemActived(t)?e.style.mainColor:"transparent":"",backgroundColor:e.halfscreen?e.isItemActived(t)?e.style.selectedTagPadding:e.style.defaultTagPadding:""},on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.checkEmo(t,i)}}},[n("v-uni-image",{staticClass:"eval-emo",class:{"index-0":0===i,"index-1":1===i&&5==e.question.items.length,"index-2":2===i&&5==e.question.items.length||1===i&&3==e.question.items.length,"index-3":3===i&&5==e.question.items.length,"index-4":4===i&&5==e.question.items.length||2===i&&3==e.question.items.length||1===i&&2==e.question.items.length,"eval-shadow":e.isItemActived(t)}}),"ALWAYS"===e.question.itemLayout||e.halfscreen?[n("v-uni-view",{staticClass:"eval-text-i",class:{active:e.isItemActived(t)}},[n("v-uni-rich-text",{staticClass:"eval-desc 2",style:{color:e.question._value===t.value?e.style.mainColor:e.style.itemColor},attrs:{nodes:t.text}})],1)]:e._e()],2)})),1),"SELECT"===e.question.itemLayout?n("v-uni-view",{class:{"show-texts":!0,hide:-1==e.currentIndex}},[-1<e.currentIndex?n("v-uni-view",{staticClass:"eval-text-i"},[n("v-uni-rich-text",{staticClass:"eval-desc",style:{color:e.style.tagColor},attrs:{nodes:e.question.items[e.currentIndex].text}})],1):e._e()],1):e._e(),-1<e.currentIndex&&e.question.items&&e.question.items[e.currentIndex]&&e.question.items[e.currentIndex].configure&&0<e.currentTags.length?n("v-uni-view",{class:{"show-tags":!0,two:2===e.currentTags.length,"adaptive-tag":"ADAPTIVE"===e.question.labelLayout}},e._l(e.currentTags,(function(t,i){return n("v-uni-view",{key:i,staticClass:"eval-tag-i flex-center",class:{active:e.isTagsActive[i]},style:{background:e.isTagsActive[i]?e.style.selectedTagPadding:e.style.defaultTagPadding,color:e.isTagsActive[i]?e.style.mainColor:e.style.tagColor,borderColor:e.isTagsActive[i]?e.style.selectedTagStroke:e.style.defaultTagStroke},on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.checkTag(t,i)}}},[n("v-uni-rich-text",{staticClass:"rich-text",attrs:{nodes:t}})],1)})),1):e._e(),e.question.hasOther&&-1<e.currentIndex?n("v-uni-textarea",{staticClass:"eval-area",style:{backgroundColor:e.style.defaultTagPadding,color:e.style.itemColor,border:"1px solid "+e.style.defaultTagStroke},attrs:{type:"textarea",placeholder:e.question.placeHolder,maxlength:"300"},on:{input:function(t){arguments[0]=t=e.$handleEvent(t),e.checkText.apply(void 0,arguments)}},model:{value:e.textarea,callback:function(t){e.textarea=t},expression:"textarea"}}):e._e()],1)}),[],!1,null,null,null,!1,void 0,void 0).exports,"hy-question-score-evaluation":(0,a.Z)({mixins:[t,o],computed:{configureJSON:function(){return"CUSTOM"!=this.imageTypeClass||"CUSTOM"==this.imageTypeClass&&!this.question.configure?null:JSON.parse(this.question.configure)},customImgs:function(){var e={};return this.configureJSON||(e={}),this.configureJSON&&this.configureJSON.forEach((function(t){e[t.type]=t.url})),e}},methods:{handleFocus:function(){this.$emit("focus",this.question.code)},handleBlur:function(){this.$emit("blur",this.question.code)}}},(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"hy-question hy-score-eval"},[n("v-uni-view",{staticClass:"show-images",class:[e.imageTypeClass]},e._l(e.question.items,(function(t,i){return n("v-uni-view",{key:i,staticClass:"q-image-i",class:{active:e.currentIndex>=i},on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.checkEmo(t,i)}}},[n("v-uni-image",{staticClass:"eval-emo",class:{star:("STAR"===e.question.inputType||"STAR"!==e.question.inputType&&(!e.configureJSON||!e.customImgs.defaultIcon))&&(-1==e.currentIndex||e.currentIndex<i),star_active:("STAR"===e.question.inputType||"STAR"!==e.question.inputType&&(!e.configureJSON||!e.customImgs.activeIcon))&&e.currentIndex>=i,icon:"ICON"===e.question.inputType&&(-1==e.currentIndex||e.currentIndex<i),icon_active:"ICON"===e.question.inputType&&e.currentIndex>=i,like:"LIKE"===e.question.inputType&&(-1==e.currentIndex||e.currentIndex<i),like_active:"LIKE"===e.question.inputType&&e.currentIndex>=i,custom:"CUSTOM"===e.question.inputType&&e.configureJSON&&e.customImgs.defaultIcon&&(-1==e.currentIndex||e.currentIndex<i),custom_active:"CUSTOM"===e.question.inputType&&e.configureJSON&&e.customImgs.activeIcon&&e.currentIndex>=i},attrs:{src:"CUSTOM"==e.question.inputType?e.currentIndex>=i?e.customImgs.activeIcon||"":e.customImgs.defaultIcon||"":""}})],1)})),1),-1<e.currentIndex?n("v-uni-view",{staticClass:"show-texts"},[n("v-uni-view",{staticClass:"q-text-i"},[n("v-uni-rich-text",{staticClass:"eval-desc",style:{color:e.style.tagColor},attrs:{nodes:e.question.items[e.currentIndex].text}})],1)],1):e._e(),-1<e.currentIndex&&e.question.items&&e.question.items[e.currentIndex]&&e.question.items[e.currentIndex].configure?n("v-uni-view",{class:{"show-tags":!0,two:2===e.currentTags.length,"adaptive-tag":"ADAPTIVE"===e.question.labelLayout}},e._l(e.currentTags,(function(t,i){return n("v-uni-view",{key:i,staticClass:"q-tag-i flex-center",class:{active:e.isTagsActive[i]},style:{background:e.isTagsActive[i]?e.style.selectedTagPadding:e.style.defaultTagPadding,color:e.isTagsActive[i]?e.style.mainColor:e.style.tagColor,borderColor:e.isTagsActive[i]?e.style.selectedTagStroke:e.style.defaultTagStroke},on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.checkTag(t,i)}}},[n("v-uni-rich-text",{staticClass:"rich-text",attrs:{nodes:t}})],1)})),1):e._e(),e.question&&e.question.hasOther&&-1<e.currentIndex?n("v-uni-textarea",{staticClass:"eval-area",style:{backgroundColor:e.style.defaultTagPadding,color:e.style.itemColor,border:"1px solid "+e.style.defaultTagStroke},attrs:{type:"textarea",placeholder:e.question.placeHolder,maxlength:"300"},on:{focus:function(t){arguments[0]=t=e.$handleEvent(t),e.handleFocus.apply(void 0,arguments)},blur:function(t){arguments[0]=t=e.$handleEvent(t),e.handleBlur.apply(void 0,arguments)},input:function(t){arguments[0]=t=e.$handleEvent(t),e.checkText.apply(void 0,arguments)}},model:{value:e.textarea,callback:function(t){e.textarea=t},expression:"textarea"}}):e._e()],1)}),[],!1,null,null,null,!1,void 0,void 0).exports,"hy-question-nps":s},props:{survey:Object,page:Object,halfscreen:Boolean},data:function(){return{componentsMap:{SCORE:"hy-question-score",SINGLE_CHOICE:"hy-question-single-choice",MULTIPLE_CHOICES:"hy-question-multiple-choice",TEXT:"hy-question-text",EVALUATION:"hy-question-evaluation",SCORE_EVALUATION:"hy-question-score-evaluation",NPS:"hy-question-nps"}}},methods:{handleFocus:function(e){this.$emit("focus",e)},handleBlur:function(e){this.$emit("blur",e)},handleQuestionChange:function(e){var t=e.key,n=e.value,i=e.comment;e=e.tags;console.debug("question ".concat(t," data changed=> value: ").concat(n," comment: ").concat(i," tags: ").concat(e)),getApp().globalData._hy_state.survey.updateValue(t,n,i,e)}}},u={components:{"hy-survey-page":(0,a.Z)(r,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-uni-view",{staticClass:"hy-sv-page"},e._l(e.page.questions,(function(t,s){return i("v-uni-view",{key:s,staticClass:"question"},[t._visible&&t._skips<=0?i("v-uni-view",[i("v-uni-view",{staticClass:"hy-q-title",style:{color:e.survey.style&&e.survey.style.questionColor||"#333333"}},[e.survey.showQuestionNumbers?i("v-uni-label",{staticClass:"index"},[e._v(e._s("MANUALLY"==e.survey.questionNumberMode?t.code:t._no)+".")]):e._e(),t.isRequired&&e.survey.showRequiredButton?i("v-uni-label",{staticClass:"required"},[e._v("*")]):e._e(),i("v-uni-rich-text",{staticClass:"text label",attrs:{nodes:t.title}})],1),i("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:!t._valid,expression:"!item._valid"}],staticClass:"hy-q-error"},[i("v-uni-image",{staticClass:"icon",attrs:{mode:"widthFix",src:n(8594),alt:""}}),i("v-uni-text",{staticClass:"message"},[e._v(e._s(t._error))])],1),i("v-uni-view",{staticClass:"hy-q-body"},["hy-question-score"==e.componentsMap[t.type]?[i("hy-question-score",{key:t.id,attrs:{question:t,page:e.page,survey:e.survey},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.handleQuestionChange.apply(void 0,arguments)}}})]:"hy-question-single-choice"==e.componentsMap[t.type]?[i("hy-question-single-choice",{key:t.id,attrs:{question:t,page:e.page,halfscreen:e.halfscreen,survey:e.survey},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.handleQuestionChange.apply(void 0,arguments)}}})]:e._e(),"hy-question-multiple-choice"==e.componentsMap[t.type]?[i("hy-question-multiple-choice",{key:t.id,attrs:{question:t,page:e.page,halfscreen:e.halfscreen,survey:e.survey},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.handleQuestionChange.apply(void 0,arguments)}}})]:"hy-question-text"==e.componentsMap[t.type]?[i("hy-question-text",{key:t.id,attrs:{question:t,page:e.page,halfscreen:e.halfscreen,survey:e.survey},on:{focus:function(t){arguments[0]=t=e.$handleEvent(t),e.handleFocus.apply(void 0,arguments)},blur:function(t){arguments[0]=t=e.$handleEvent(t),e.handleBlur.apply(void 0,arguments)},change:function(t){arguments[0]=t=e.$handleEvent(t),e.handleQuestionChange.apply(void 0,arguments)}}})]:e._e(),"hy-question-evaluation"==e.componentsMap[t.type]?[i("hy-question-evaluation",{key:t.id,attrs:{question:t,page:e.page,halfscreen:e.halfscreen,survey:e.survey},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.handleQuestionChange.apply(void 0,arguments)}}})]:"hy-question-score-evaluation"==e.componentsMap[t.type]?[i("hy-question-score-evaluation",{key:t.id,attrs:{question:t,page:e.page,survey:e.survey},on:{focus:function(t){arguments[0]=t=e.$handleEvent(t),e.handleFocus.apply(void 0,arguments)},blur:function(t){arguments[0]=t=e.$handleEvent(t),e.handleBlur.apply(void 0,arguments)},change:function(t){arguments[0]=t=e.$handleEvent(t),e.handleQuestionChange.apply(void 0,arguments)}}})]:e._e(),"hy-question-nps"==e.componentsMap[t.type]?[i("hy-question-nps",{key:t.id,attrs:{question:t,page:e.page,survey:e.survey},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.handleQuestionChange.apply(void 0,arguments)}}})]:e._e()],2)],1):e._e()],1)})),1)}),[],!1,null,null,null,!1,void 0,void 0).exports},props:{delay:Number,borderRadiusMode:{type:String,default:null},resize:Boolean,show:Boolean,surveyId:String,channelId:String,token:String,options:Object,parameters:Object,maxHeightValue:String,heightValue:String},computed:{halfscreen:function(){return null!==this.options&&void 0!==this.options&&this.options.halfscreen||!1},pages:function(){return this.survey&&this.survey.pages?this.survey.pages.filter((function(e){return!e.isEmpty})):[]},topRadius:function(){return this.survey&&this.survey.channel&&this.borderRadiusMode&&"TOP"!=this.borderRadiusMode?this.survey.channel.configure.appBorderRadius:"0px"},bottomRadius:function(){return this.survey&&this.survey.channel&&this.borderRadiusMode&&"BUTTOM"!=this.borderRadiusMode?this.survey.channel.configure.appBorderRadius:"0px"},pageIndex:function(){return this.survey&&this.survey._currentPage&&this.survey._currentPage._index||0},hasNextPage:function(){var e=this;return!!(this.survey&&this.survey.pages&&this.survey.pages.length>this.pageIndex+1&&0<this.pages.filter((function(t){return t._index>e.pageIndex&&!t.isEmpty})).map((function(e){return e._index})).length)},hasPreviousPage:function(){return!!(this.survey&&this.pages&&0<this.pages.length&&0<this.pageIndex)},abnormalConcludingRemark:function(){if(this.survey)try{var e=JSON.parse(this.survey.abnormalConcludingRemark);return e&&"object"===(0,i.Z)(e)?e.text:this.survey.abnormalConcludingRemark}catch(e){return this.survey.abnormalConcludingRemark}return""},concludingRemark:function(){if(this.survey)try{var e=JSON.parse(this.survey.concludingRemark);return e&&"object"===(0,i.Z)(e)?e.text:this.survey.concludingRemark}catch(e){return this.survey.concludingRemark}return""},backgroundColor:function(){return this.survey&&this.survey.style&&this.survey.showBackground?this.survey.style.backgroundColor:""}},data:function(){return{observer:null,survey:null,status:"init",surveyError:"",scrollTop:0,surveyIsRequesting:!1,isRequesting:!1,hideInterval:null,scrollInter:null,isH5:null!=window,sessionInfo:null,debounceTimer:null,timer:null,delayGoTime:400,scrollViewHeight:"100%",_surveyId:"",_channelId:""}},created:function(){getApp().globalData._hy_subscribe(this.goNextPageEve)},mounted:function(){var e,t=this;this.resize&&(this.observer=new ResizeObserver((function(e){e.forEach((function(e){console.debug("onSize: "+e.contentRect.height),t.$emit("size",{width:e.contentRect.width,height:e.contentRect.height})}))})),e=document.querySelector(".sv-scroll-view"),this.observer.observe(e,{attributes:!0,childList:!0,subtree:!0})),this.token?this.embedBySendToken():(this._surveyId=this.surveyId,this._channelId=this.channelId,this.loadSurvey(),console.debug("survey created",this._surveyId,this._channelId,this.options,this.parameters,this.token))},unmounted:function(){this.observer&&(this.observer.disconnect(),this.observer=null)},methods:{handleFocus:function(e){this.$emit("focus",e)},handleBlur:function(e){this.$emit("blur",e)},getHeightValue:function(e,t){return 0<e.indexOf("%")?parseInt((t*parseInt(e)/100).toFixed()):parseInt(e)},getMaxHeightNum:function(e){return"auto"==this.heightValue?this.getHeightValue(this.maxHeightValue,e):this.getHeightValue(this.heightValue,e)},setScrollViewHeight:function(){var e=this,t=uni.getSystemInfoSync();if("app"!=t.uniPlatform)return e.scrollTop=0,!1;t=t.windowHeight;var n=this.getMaxHeightNum(t);uni.createSelectorQuery().select("#survey-pages").boundingClientRect().exec((function(t){t&&t[0]&&(uni.createSelectorQuery().select("#survey-actions").boundingClientRect().exec((function(i){i&&i[0]&&(i=i[0].height+t[0].height,e.scrollViewHeight=n<i?n+"px":"100%")})),uni.pageScrollTo({duration:300,scrollTop:0})),e.scrollTop=0}))},embedBySendToken:function(){var e=this;getApp().globalData._hy_state.service.embedBySendToken(this.token).then((function(t){t.surveyId&&t.channelId?(e._surveyId=t.surveyId,e._channelId=t.channelId,console.debug("survey created",e._surveyId,e._channelId,e.options,e.parameters,e.token),e.loadSurvey()):console.debug("embedBySendToken res warning: 数据接入入小程序调用异常，",t)})).catch((function(e){console.debug("embedBySendToken error: 数据接入小程序调用失败",e)}))},distubUploadEve:function(e){var t=this.survey&&this.survey.responseId||"";getApp().globalData._hy_state.service.distubUploadSend(this._surveyId,e,t)},goNextPageEve:function(e,t){"goNextPage"===e&&this.handleNext(),"submit"===e&&this.handleSubmit()},loadSurvey:function(){var e=this,t=this;this._surveyId&&this._channelId&&!this.surveyIsRequesting&&(this.surveyIsRequesting=!0,getApp().globalData._hy_state.service.loadSurveyFromServer(this._surveyId,this._channelId,this.options,this.parameters,this.token).then((function(n){n._startTime=new Date,(e.survey=n).goNextPageAutomatic||(e.delayGoTime=0),getApp().globalData._hy_survey=e.survey,e.sessionInfo=getApp().globalData._hy_state.service.sessions[e.survey.id],e.$emit("load",e.survey),e.options.mode&&"preview"==e.options.mode||e.distubUploadEve("OPEN"),e.surveyIsRequesting=!1,e.scrollInter=setTimeout((function(){t.setScrollViewHeight()}),400)})).catch((function(t){e.surveyError=t||"系统错误",e.surveyIsRequesting=!1,e.$emit("loadfailed",t),e.$emit("hide",t),e.sessionInfo=null})))},handleSubmit:function(){var e=this;!this.isRequesting&&this.sessionInfo&&(clearTimeout(this.timer),this.timer=setTimeout((function(){e.isRequesting=!0,e.survey.performSubmit(e.sessionInfo,e.parameters,e.options.mode).then((function(t){t&&(e.survey._isEarlyCompleted||e.survey._isFinished)&&(e.status="finish"),getApp().globalData._hy_unsubscribe(e.goNextPageEve),e.isRequesting=!1,e.sessionInfo=null,e.$emit("submit"),e.handleHide()})).catch((function(t){e.isRequesting=!1,t&&(e.sessionInfo=null,e.surveyError=t||"系统错误",e.$emit("submitfailed",t),e.handleHide())}))}),this.delayGoTime))},handleHide:function(){var e=this;this.hideInterval=setTimeout((function(){e.$emit("hide","autoclose")}),e.delay)},handleNext:function(){var e=this;this.surveyError="",!this.isRequesting&&this.sessionInfo&&(clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout((function(){e.isRequesting=!0,e.survey.performNext(e.sessionInfo,e.parameters,e.options.mode).then((function(t){t&&(e.survey._isFinished||e.survey._isEarlyCompleted?(e.status="finish",e.survey._isEarlyCompleted&&e.handleHide(),e.sessionInfo=null):(e.survey.performNextPage(),e.scrollTop=e.oldScrollTop,e.scrollInter=setTimeout((function(){e.setScrollViewHeight()}),400))),e.isRequesting=!1})).catch((function(t){e.isRequesting=!1,t&&(e.sessionInfo=null,e.surveyError=t||"error",e.handleHide())}))}),this.delayGoTime))},handleScroll:function(e){this.scrollTop=e.detail.scrollTop},handlePrevious:function(){var e=this;this.survey.performPrevPage(),this.scrollInter=setTimeout((function(){e.setScrollViewHeight()}),400)}},beforeDestroy:function(){this.hideInterva&&clearTimeout(this.hideInterval),this.hideInterval=null,this.scrollInter&&clearTimeout(this.scrollInter),this.scrollInter=null}},(0,a.Z)(u,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"hy-survey-wrap",class:{mp:!e.isH5,"half-screen-survey":e.halfscreen},style:{borderTopLeftRadius:e.topRadius,borderTopRightRadius:e.topRadius,borderBottomLeftRadius:e.bottomRadius,borderBottomRightRadius:e.bottomRadius,backgroundColor:e.survey&&e.survey.showBackground&&e.backgroundColor?e.backgroundColor:"white"}},[e.surveyIsRequesting?i("v-uni-view",{staticClass:"sv-loading"},[i("v-uni-view",{staticClass:"out-div"})],1):e._e(),i("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:e.survey&&e.isRequesting&&e.survey.goNextPageAutomatic,expression:"survey && isRequesting && survey.goNextPageAutomatic"}],staticClass:"survey-loading-view"}),e.show?i("v-uni-scroll-view",{staticClass:"hy-survey sv-scroll-view",style:{height:e.scrollViewHeight},attrs:{"scroll-y":"true","scroll-top":e.scrollTop},on:{scroll:function(t){arguments[0]=t=e.$handleEvent(t),e.handleScroll.apply(void 0,arguments)}}},[e.surveyError||"finish"==e.status?i("v-uni-view",{staticClass:"hy-survey survey-completed flex-center"},[i("v-uni-view",{staticClass:"hy-finish",class:{error:e.surveyError,"flex-center":!e.surveyError}},[e.surveyError?i("v-uni-view",{staticClass:"text-error"},[i("img",{attrs:{src:n(2105),alt:""}}),i("v-uni-view",{staticClass:"remark"},[e._v(e._s(e.surveyError))])],1):e.survey?i("v-uni-view",{staticClass:"default-finish"},[i("v-uni-rich-text",{staticClass:"text",class:e.survey._isEarlyCompleted?"early":"",attrs:{nodes:e.survey._isEarlyCompleted?e.abnormalConcludingRemark:e.concludingRemark}})],1):e._e()],1)],1):e.survey&&e.pages&&e.show&&0==e.pages.length&&null==e.survey._currentPage?i("v-uni-view",{staticClass:"hy-survey survey-completed flex-center no-question-error"},[i("v-uni-view",{staticClass:"text-error"},[i("img",{attrs:{src:n(2105),alt:""}}),i("v-uni-view",{staticClass:"remark"},[e._v("问卷中没有问题或页面")])],1)],1):e.survey&&e.pages&&e.show?i("v-uni-view",{staticClass:"survey-pages",class:{"hide-btn":!e.survey._hasValue,"hide-logo":!e.survey.showBrand},attrs:{id:"survey-pages"}},[e._l(e.pages,(function(t,n){return[t.isEmpty?e._e():i("v-uni-view",{key:n,staticClass:"pages-row"},[t&&e.pageIndex===t._index?i("hy-survey-page",{attrs:{index:t._index,page:t,survey:e.survey,halfscreen:e.halfscreen},on:{focus:function(t){arguments[0]=t=e.$handleEvent(t),e.handleFocus.apply(void 0,arguments)},blur:function(t){arguments[0]=t=e.$handleEvent(t),e.handleBlur.apply(void 0,arguments)}}}):e._e()],1)]})),i("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:e.survey._hasValue,expression:"survey._hasValue"}],staticClass:"survey-actions",class:{"only-one-btn":!e.hasPreviousPage,"two-btn":e.hasPreviousPage,"has-logo":e.survey&&e.survey.showBrand},attrs:{id:"survey-actions"}},[e.hasPreviousPage?i("v-uni-button",{staticClass:"action previous",style:{backgroundColor:"#f6f6f6"},attrs:{size:"mini",type:"primary"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handlePrevious()}}},[e._v("上一页")]):e._e(),e.hasNextPage?i("v-uni-button",{staticClass:"action next",class:{exclusive:!e.hasPreviousPage,btn_loading:e.isRequesting},style:{backgroundColor:e.survey.style.enableCustomButton?e.survey.style.buttonColor:e.survey.style.mainColor},attrs:{size:"mini",type:"primary"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleNext()}}},[e._v("下一页")]):e._e(),e.hasNextPage?e._e():i("v-uni-button",{staticClass:"action submit",class:{exclusive:!e.hasPreviousPage,btn_loading:e.isRequesting},style:{backgroundColor:e.survey.style.enableCustomButton?e.survey.style.buttonColor:e.survey.style.mainColor},attrs:{size:"mini",type:"primary"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleSubmit()}}},[e._v("提交")])],1)],2):e._e(),e.survey&&e.survey.showBrand&&!e.surveyError&&"finish"!=e.status?i("v-uni-view",{staticClass:"survey-footer"},[e.survey.brandLogo?i("v-uni-view",{staticClass:"footer-logo logo-view",style:{backgroundImage:"url("+e.survey.brandLogo+")",backgroundSize:"auto 14px"}}):i("v-uni-image",{staticClass:"footer-logo default-logo",class:{"lynkco-default-logo":"lynkco"==e.options.project}})],1):e._e()],1):i("v-uni-view",{staticClass:"survey-errored"})],1)}),[],!1,null,"a092e8e6",null,!1,void 0,void 0).exports)},5030:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{S:function(){return npsMixin}});var core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1539),core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(4747),core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(7658),core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es_object_keys_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(7941),core_js_modules_es_object_keys_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es_object_keys_js__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es_array_concat_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(2222),core_js_modules_es_array_concat_js__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es_array_concat_js__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_es_parse_int_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(1058),core_js_modules_es_parse_int_js__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_es_parse_int_js__WEBPACK_IMPORTED_MODULE_5__),core_js_modules_es_array_index_of_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(2772),core_js_modules_es_array_index_of_js__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(core_js_modules_es_array_index_of_js__WEBPACK_IMPORTED_MODULE_6__),core_js_modules_es_array_splice_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(561),core_js_modules_es_array_splice_js__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(core_js_modules_es_array_splice_js__WEBPACK_IMPORTED_MODULE_7__),npsMixin={data:function(){return{currentIndex:null,checkedTags:[],checkedIndex:[],textarea:"",tagDefaultStyle:null,tagActiveStyle:null,imageTypeClass:"",totalTypeList:{EQUAL:"==",NOT_EQUAL:"!=",GREATER_THAN:">",GREATER_THAN_EQUAL:">=",LESS_THAN:"<",LESS_THAN_EQUAL:"<="}}},computed:{currentTags:function(){return-1<this.currentIndex?this.question.items[this.currentIndex].configure.split(","):[]},isTagsActive:function(){var e=this,t=[];return this.currentTags.forEach((function(n){-1<e.arrayfind(e.checkedTags,n)?t.push(!0):t.push(!1)})),t},showTextarea:function showTextarea(){var visibleConditio,comparison,comparisonValue;return!this.question.configure||void 0===this.question._value||(visibleConditio=JSON.parse(this.question.configure).visibleConditio,comparison=visibleConditio.comparison?this.totalTypeList[visibleConditio.comparison]:"",comparisonValue=visibleConditio.comparisonValue||null,!comparison||!comparisonValue||eval("".concat(parseInt(this.question._value)," ").concat(comparison," ").concat(parseInt(comparisonValue))))}},beforeMount:function(){this.init()},methods:{init:function(){var e=this,t=this;!this.question._value&&this.question.isDefaultValue&&(this.question._value=+this.question.evaluationValue),this.question._value&&(this.question.items.forEach((function(n,i){t.question._value<=6?(t.currentIndex=0,e.setTags(e.question.items[0])):6<t.question._value&&t.question._value<=8?(t.currentIndex=1,e.setTags(e.question.items[1])):8<t.question._value&&t.question._value<=10&&(t.currentIndex=2,e.setTags(e.question.items[2]))})),this.question._comment&&(this.textarea=this.question._comment),this.changeValue()),this.tagDefaultStyle={background:this.style.defaultTagPadding,color:this.style.tagColor,borderColor:this.style.defaultTagStroke},this.tagActiveStyle={background:this.style.selectedTagPadding,color:this.style.mainColor,borderColor:this.style.selectedTagStroke},this.imageTypeClass=this.question.inputType},setTags:function(e){var t=this,n=this.question._tags;n&&n.length&&e.configure&&e.configure.split(",").forEach((function(e,i){-1<n.indexOf(e)&&(t.checkedIndex.push(i),t.checkedTags.push(e))}))},changeValue:function(){var e={key:this.question.name,value:this.value,comment:this.textarea||null,tags:0<this.checkedTags.length?this.checkedTags:null};this.$emit("change",e)},checkTag:function(e,t){var n=this.checkedIndex.indexOf(t);-1!=n?(this.checkedIndex.splice(n,1),this.checkedTags.splice(n,1)):(this.checkedIndex.push(t),this.checkedTags.push(e)),this.question._tags=this.checkedTags,this.changeValue()},checkText:function(){this.changeValue()}}}},4986:function(e,t,n){var i=n(2109);n=n(6583);i({target:"Array",proto:!0,forced:n!==[].lastIndexOf},{lastIndexOf:n})},2443:function(e,t,n){n(6800)("asyncIterator")},8594:function(e,t,n){"use strict";e.exports=n.p+"static/img/hy-question-error.svg"},2105:function(e,t,n){"use strict";e.exports=n.p+"static/img/stopSurvey_page.svg"},4587:function(e,t,n){"use strict";function i(e,t,n,i,s,o,a){try{var r=e[o](a),u=r.value}catch(e){return void n(e)}r.done?t(u):Promise.resolve(u).then(i,s)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(s,o){var a=e.apply(t,n);function r(e){i(a,s,o,r,u,"next",e)}function u(e){i(a,s,o,r,u,"throw",e)}r(void 0)}))}}n.d(t,{Z:function(){return s}}),n(1539)},6407:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}}),n(9070),n(2526),n(1817),n(1539),n(2165),n(8783),n(3948),n(2443),n(3680),n(3706),n(2703),n(489),n(1703),n(6647),n(7658),n(4747),n(8304),n(5069),n(7042);var i=n(6257);function s(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
s=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(t){c=function(e,t,n){return e[t]=n}}function h(e,t,n,i){var s,a,r,u;t=t&&t.prototype instanceof _?t:_,t=Object.create(t.prototype),i=new C(i||[]);return o(t,"_invoke",{value:(s=e,a=n,r=i,u="suspendedStart",function(e,t){if("executing"===u)throw new Error("Generator is already running");if("completed"===u){if("throw"===e)throw t;return T()}for(r.method=e,r.arg=t;;){var n=r.delegate;if(n&&(n=function e(t,n){var i=n.method,s=t.iterator[i];return void 0===s?(n.delegate=null,"throw"===i&&t.iterator.return&&(n.method="return",n.arg=void 0,e(t,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),v):(i=d(s,t.iterator,n.arg),"throw"===i.type?(n.method="throw",n.arg=i.arg,n.delegate=null,v):(s=i.arg,s?s.done?(n[t.resultName]=s.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=void 0),n.delegate=null,v):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)))}(n,r),n)){if(n===v)continue;return n}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===u)throw u="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);if(u="executing",n=d(s,a,r),"normal"===n.type){if(u=r.done?"completed":"suspendedYield",n.arg===v)continue;return{value:n.arg,done:r.done}}"throw"===n.type&&(u="completed",r.method="throw",r.arg=n.arg)}})}),t}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=h;var v={};function _(){}function y(){}function p(){}a={};var g=(c(a,r,(function(){return this})),Object.getPrototypeOf),f=(g=g&&g(g(k([]))),g&&g!==t&&n.call(g,r)&&(a=g),p.prototype=_.prototype=Object.create(a));function m(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function q(e,t){var s;o(this,"_invoke",{value:function(o,a){function r(){return new t((function(s,r){!function s(o,a,r,u){var l;o=d(e[o],e,a);if("throw"!==o.type)return(a=(l=o.arg).value)&&"object"==(0,i.Z)(a)&&n.call(a,"__await")?t.resolve(a.__await).then((function(e){s("next",e,r,u)}),(function(e){s("throw",e,r,u)})):t.resolve(a).then((function(e){l.value=e,r(l)}),(function(e){return s("throw",e,r,u)}));u(o.arg)}(o,a,s,r)}))}return s=s?s.then(r,r):r()}})}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function b(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function k(e){if(e){var t,i=e[r];if(i)return i.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return t=-1,(i=function i(){for(;++t<e.length;)if(n.call(e,t))return i.value=e[t],i.done=!1,i;return i.value=void 0,i.done=!0,i}).next=i}return{next:T}}function T(){return{value:void 0,done:!0}}return o(f,"constructor",{value:y.prototype=p,configurable:!0}),o(p,"constructor",{value:y,configurable:!0}),y.displayName=c(p,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){return e="function"==typeof e&&e.constructor,!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,c(e,l,"GeneratorFunction")),e.prototype=Object.create(f),e},e.awrap=function(e){return{__await:e}},m(q.prototype),c(q.prototype,u,(function(){return this})),e.AsyncIterator=q,e.async=function(t,n,i,s,o){void 0===o&&(o=Promise);var a=new q(h(t,n,i,s),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},m(f),c(f,l,"Generator"),c(f,r,(function(){return this})),c(f,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t,n=Object(e),i=[];for(t in n)i.push(t);return i.reverse(),function e(){for(;i.length;){var t=i.pop();if(t in n)return e.value=t,e.done=!1,e}return e.done=!0,e}},e.values=k,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(b),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(n,i){return a.type="throw",a.arg=e,t.next=n,i&&(t.method="next",t.arg=void 0),!!i}for(var s=this.tryEntries.length-1;0<=s;--s){var o=this.tryEntries[s],a=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var r=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(r&&u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(r){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;0<=i;--i){var s=this.tryEntries[i];if(s.tryLoc<=this.prev&&n.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var o=s;break}}var a=(o=o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc?null:o)?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),b(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n,i,s=this.tryEntries[t];if(s.tryLoc===e)return"throw"===(n=s.completion).type&&(i=n.arg,b(s)),i}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:k(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),v}},e}}}]);